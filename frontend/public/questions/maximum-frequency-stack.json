{
  "index": 0,
  "filename": "maximum-frequency-stack",
  "title": "Maximum Frequency Stack",
  "keywords": [
    "stack",
    "frequency",
    "maximum",
    "hash map",
    "data structure",
    "push",
    "pop",
    "count",
    "priority",
    "design"
  ],
  "description": "<h2>Maximum Frequency Stack</h2><p>Design a stack-like data structure that pops the most frequent element.</p><p>Implement the <code>FreqStack</code> class:</p><ul><li><code>FreqStack()</code>: Constructs an empty frequency stack</li><li><code>push(val)</code>: Pushes an integer <code>val</code> onto the top of the stack</li><li><code>pop()</code>: Removes and returns the most frequent element in the stack. If there is a tie for the most frequent element, the element closest to the stack's top is removed and returned</li></ul><h3>Examples:</h3><ul><li>Input:<br>[\"FreqStack\", \"push\", \"push\", \"push\", \"push\", \"push\", \"push\", \"pop\", \"pop\", \"pop\", \"pop\"]<br>[[], [5], [7], [5], [7], [4], [5], [], [], [], []]<br><br>Output:<br>[null, null, null, null, null, null, null, 5, 7, 5, 4]<br><br>Explanation:<br>FreqStack freqStack = new FreqStack();<br>freqStack.push(5); // stack: [5]<br>freqStack.push(7); // stack: [5,7]<br>freqStack.push(5); // stack: [5,7,5]<br>freqStack.push(7); // stack: [5,7,5,7]<br>freqStack.push(4); // stack: [5,7,5,7,4]<br>freqStack.push(5); // stack: [5,7,5,7,4,5]<br>freqStack.pop();   // return 5 (freq=3), stack: [5,7,5,7,4]<br>freqStack.pop();   // return 7 (freq=2), stack: [5,7,5,4]<br>freqStack.pop();   // return 5 (freq=2), stack: [5,7,4]<br>freqStack.pop();   // return 4 (freq=1), stack: [5,7]</li></ul><h3>Constraints:</h3><ul><li><code>0 <= val <= 10^9</code></li><li>At most <code>2 * 10^4</code> calls will be made to <code>push</code> and <code>pop</code></li><li>It is guaranteed that there will be at least one element in the stack before calling <code>pop</code></li></ul>",
  "entry_function": "executeFreqStackOperations",
  "template": "class FreqStack:\n    def __init__(self):\n        \n    \n    def push(self, val):\n        \n    \n    def pop(self):\n        ",
  "solution_text": "<h3>Maximum Frequency Stack</h3><p><strong>Algorithm:</strong></p><ol><li>Use three data structures:<ul><li><code>freq</code>: Map from value to its current frequency</li><li><code>group</code>: Map from frequency to stack of values with that frequency</li><li><code>maxfreq</code>: Track the current maximum frequency</li></ul></li><li><strong>Push operation:</strong><ul><li>Increment frequency of value in freq map</li><li>Get new frequency f</li><li>Add value to group[f] stack</li><li>Update maxfreq if f is greater</li></ul></li><li><strong>Pop operation:</strong><ul><li>Get the stack at group[maxfreq]</li><li>Pop value from that stack</li><li>Decrement freq[value]</li><li>If group[maxfreq] is empty, decrement maxfreq</li><li>Return the popped value</li></ul></li></ol><p><strong>Time Complexity:</strong> O(1) for both push and pop</p><p><strong>Space Complexity:</strong> O(n) where n is the number of elements</p><p><strong>Key Insights:</strong></p><ul><li>Group elements by frequency to quickly find most frequent</li><li>Within each frequency group, maintain stack ordering (LIFO for ties)</li><li>maxfreq pointer eliminates need to search for max frequency</li><li>When popping, automatically handle the \"most recent\" tie-breaking</li><li>Frequency groups naturally maintain insertion order</li></ul>",
  "solution_code": "class FreqStack:\n    def __init__(self):\n        self.freq = {}  # value -> current frequency count\n        self.group = {}  # frequency -> list of values at that frequency  \n        self.maxfreq = 0\n    \n    def push(self, val):\n        # Increment this value's frequency\n        f = self.freq.get(val, 0) + 1\n        self.freq[val] = f\n        \n        # Add this value to the group at frequency f\n        if f not in self.group:\n            self.group[f] = []\n        self.group[f].append(val)\n        \n        # Update max frequency if this is now the highest\n        if f > self.maxfreq:\n            self.maxfreq = f\n    \n    def pop(self):\n        # Get the most recently added value at the highest frequency\n        val = self.group[self.maxfreq].pop()\n        \n        # Decrement this value's frequency count\n        self.freq[val] -= 1\n        \n        # If we just emptied the highest frequency group, decrease maxfreq\n        if len(self.group[self.maxfreq]) == 0:\n            self.maxfreq -= 1\n        \n        return val",
  "prepare": "# Define the wrapper function that will execute operations\ndef executeFreqStackOperations(operations, values):\n    results = []\n    stack = None\n    for i, (op, val) in enumerate(zip(operations, values)):\n        if op == 'FreqStack':\n            stack = FreqStack()\n            results.append(None)\n        elif op == 'push':\n            results.append(stack.push(val[0]))\n        elif op == 'pop':\n            results.append(stack.pop())\n    return results\n\ndef prepare(test_case_input):\n    \"\"\"Prepare arguments for executeFreqStackOperations function\"\"\"\n    return (test_case_input['operations'], test_case_input['values'])",
  "verify": "def verify(actual_output, expected_output):\n    \"\"\"Verify the frequency stack operations result\"\"\"\n    if len(actual_output) != len(expected_output):\n        return [False, str(actual_output)]\n    \n    for i, (actual, expected) in enumerate(zip(actual_output, expected_output)):\n        if actual != expected:\n            return [False, str(actual_output)]\n    \n    return [True, str(actual_output)]",
  "test_cases": [
    {
      "id": 1,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "push",
          "push",
          "push",
          "pop",
          "pop",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            5
          ],
          [
            7
          ],
          [
            5
          ],
          [
            7
          ],
          [
            4
          ],
          [
            5
          ],
          [],
          [],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        5,
        7,
        5,
        4
      ]
    },
    {
      "id": 2,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            1
          ],
          [
            1
          ],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        1,
        1
      ]
    },
    {
      "id": 3,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "pop"
        ],
        "values": [
          [],
          [
            1
          ],
          [
            2
          ],
          [
            3
          ],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        3
      ]
    },
    {
      "id": 4,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "push",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            4
          ],
          [
            4
          ],
          [
            4
          ],
          [
            4
          ],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        null,
        4,
        4
      ]
    },
    {
      "id": 5,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "push",
          "push",
          "pop",
          "push",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            1
          ],
          [
            2
          ],
          [
            1
          ],
          [
            2
          ],
          [
            1
          ],
          [],
          [
            3
          ],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        null,
        null,
        1,
        null,
        2,
        1
      ]
    },
    {
      "id": 6,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "push",
          "push",
          "push",
          "pop",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            9
          ],
          [
            8
          ],
          [
            9
          ],
          [
            8
          ],
          [
            9
          ],
          [
            8
          ],
          [],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        8,
        9,
        8
      ]
    },
    {
      "id": 7,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "pop"
        ],
        "values": [
          [],
          [
            5
          ],
          []
        ]
      },
      "output": [
        null,
        null,
        5
      ]
    },
    {
      "id": 8,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "pop",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            1
          ],
          [
            2
          ],
          [
            3
          ],
          [],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        3,
        2,
        1
      ]
    },
    {
      "id": 9,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "push",
          "push",
          "pop",
          "pop",
          "pop",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            10
          ],
          [
            20
          ],
          [
            10
          ],
          [
            30
          ],
          [
            10
          ],
          [],
          [],
          [],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        null,
        null,
        10,
        10,
        30,
        20,
        10
      ]
    },
    {
      "id": 10,
      "input": {
        "operations": [
          "FreqStack",
          "push",
          "push",
          "push",
          "push",
          "push",
          "push",
          "pop",
          "pop",
          "push",
          "pop",
          "pop"
        ],
        "values": [
          [],
          [
            7
          ],
          [
            7
          ],
          [
            3
          ],
          [
            7
          ],
          [
            3
          ],
          [
            3
          ],
          [],
          [],
          [
            7
          ],
          [],
          []
        ]
      },
      "output": [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        3,
        7,
        null,
        7,
        3
      ]
    }
  ]
}